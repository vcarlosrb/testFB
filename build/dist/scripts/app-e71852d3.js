/**
 * generator-cg-gas - Yeoman Generator for Enterprise Angular projects, with Gulp Angular Sass
 * @version v3.3.4
 * @link https://github.com/Lunatic83/generator-cg-gas
 * @license 
 */
angular.module("facebook",["ui.bootstrap","ui.utils","ui.router","ngAnimate"]),angular.module("facebook").config(["$stateProvider","$urlRouterProvider","$locationProvider",function($stateProvider,$urlRouterProvider,$locationProvider){$stateProvider.state("app",{url:"/","abstract":!0,resolve:{Storage:["User",function(User){User.createUsers()}]}}),$stateProvider.state("app.login",{url:"login",parent:"app",views:{"@":{templateUrl:"partial/Public/login//login.html"}}}),$stateProvider.state("app.private",{url:"",parent:"app","abstract":!0,resolve:{UserData:["$timeout","$state","User",function($timeout,$state,User){var userId=localStorage.getItem("userId");if(!userId)return $timeout(function(){$state.go("app.login")});var users=User.getUsers();users.forEach(function(user){if(userId==user.id)return user})}]},views:{"@":{templateUrl:"partial/Private/layout//layout.html"},"header@app.private":{templateUrl:"partial/Private/header//header.html"},"panel@app.private":{templateUrl:"partial/Private/panel//panel.html"}}}),$stateProvider.state("app.private.home",{url:"",parent:"app.private",views:{"content@app.private":{templateUrl:"partial/Private/home//home.html"},"aside@app.private":{templateUrl:"partial/Private/ad//ad.html"}}}),$urlRouterProvider.otherwise("/")}]),angular.module("facebook").run(["$rootScope",function($rootScope){$rootScope.safeApply=function(fn){var phase=$rootScope.$$phase;"$apply"===phase||"$digest"===phase?fn&&"function"==typeof fn&&fn():this.$apply(fn)}}]),angular.module("facebook").controller("MainCtrl",["$scope",function($scope){}]),angular.module("facebook").controller("LoginCtrl",["$scope","Validate","User","$state",function($scope,Validate,User,$state){$scope.Form={},$scope.Valid={email:!1,regex:!1,password:!1},$scope.Loader={login:!1},$scope.Events={login:function(form){$scope.Validate.login(form)&&!$scope.Loader.login&&($scope.Loader.login=!0,$scope.Services.login(form))}},$scope.Services={login:function(form){User.login(form).then(function(response){User.setUserId(response.user.id),$state.go("app.private.home"),$scope.Loader.login=!1},function(err){swal("Error!",err.message,"error"),$scope.Loader.login=!1})}},$scope.Validate={login:function(form){return $scope.Valid={email:""==form.email||void 0==form.email,password:""==form.password||void 0==form.password},$scope.Valid.email||($scope.Valid.regex=!Validate.Email(form.email)),!$scope.Valid.email&&!$scope.Valid.password&&!$scope.Valid.regex}}}]),angular.module("facebook").factory("Validate",function(){return{Email:function(email){var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email)}}}),angular.module("facebook").factory("Generator",function(){return{s4:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},uniqueId:function(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()}}}),angular.module("facebook").controller("HomeCtrl",["$scope","Post","User",function($scope,Post,User){$scope.Posts=[],$scope.User={},$scope.Images=[],$scope.Filter={type:""},$scope.Form={type:"friends"},$scope.Valid={statement:!1},$scope.Loader={post:!1},$scope.Modal={constructor:function(){this.closeWindow()},closeWindow:function(){var self=this;$(".Image__shadow").on("click",function(){self.close()}),$(".Image__content").on("click",function(e){e.stopPropagation()})},show:function(img){$("#Image__modal").attr("src",img),$("#Image__modal").css({"max-width":$(window).width()-90,"max-height":$(window).height()-90}),$(".Modal__image").fadeIn(100)},close:function(){$(".Modal__image").fadeOut(100)}},$scope.Modal.constructor(),$scope.Image={previewImage:function(input){if(input.files&&input.files[0]){var reader=new FileReader;reader.onload=function(e){$scope.$apply(function(){$scope.Images[0]=e.target.result})},reader.readAsDataURL(input.files[0])}},changeInput:function(){this.previewImage($("#Input__file")[0])},cancelImage:function(index,List){List.splice(index,1)}},$scope.Events={createPost:function(form){$scope.Validate.createPost(form)&&!$scope.Loader.post&&($scope.Loader.post=!0,$scope.Services.createPost(form))},editPost:function(post){post.edit=!0,post.editStatement=angular.copy(post.statement)},cancelEdit:function(post){post.edit=!1},savePost:function(post){$scope.Validate.savePost(post)&&$scope.Services.savePost(post)},removePost:function(post,index,List){swal({title:"¿Eliminar publicacion?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Eliminar",closeOnConfirm:!1},function(){$scope.Services.removePost(post,index,List)})}},$scope.Services={constructor:function(){this.getPost(),this.getUserData()},getUserData:function(){User.getUserData().then(function(response){$scope.User=response})},getPost:function(){Post.getPostByUser(User.getUserId()).then(function(response){response.forEach(function(post){post.edit=!1,post.valid={statement:!1},post.created=moment(post.createdAt).format("MMMM Do YYYY, h:mm:ss a")}),response=response.reverse(),$scope.Posts=response})},createPost:function(form){var post={statement:form.statement,userId:User.getUserId(),createdAt:new Date,type:form.type};$scope.Images.length>0&&(post.image=$scope.Images[0]),Post.create(post).then(function(response){response.user=$scope.User,response.created=moment(response.createdAt).format("MMMM Do YYYY, h:mm:ss a"),$scope.Posts.unshift(response),$scope.Loader.post=!1,$scope.Form.statement="",$scope.Valid.statement=!1,$scope.Images=[]})},savePost:function(post){Post.save(post.id,post.editStatement).then(function(response){post.edit=!1,post.statement=angular.copy(post.editStatement),swal("¡Publicacion actualizada!","","success")})},removePost:function(post,index,List){Post.remove(post.id).then(function(response){List.splice(index,1),swal("¡Publicacion eliminada!","","success")})}},$scope.Services.constructor(),$scope.Validate={createPost:function(form){return $scope.Valid={statement:""==form.statement||void 0==form.statement},!$scope.Valid.statement},savePost:function(post){return post.valid={statement:""==post.editStatement||void 0==post.editStatement},!post.valid.statement}}}]),angular.module("facebook").controller("LayoutCtrl",["$scope",function($scope){}]),angular.module("facebook").controller("HeaderCtrl",["$scope","$timeout","$state",function($scope,$timeout,$state){$scope.Events={menu:!1,init:function(){this.closeMenu()},closeMenu:function(){var self=this;$("body").on("click",function(){if(self.menu){var target=angular.element("#Menu");target.css("display","none"),self.menu=!1}})},toggleMenu:function(){var target=angular.element("#Menu"),self=this;self.menu||(target.css("display","block"),$timeout(function(){self.menu=!0},100))}},$scope.Events.init(),$scope.Services={logout:function(){localStorage.removeItem("userId"),$state.go("app.login")}}}]),angular.module("facebook").controller("PanelCtrl",["$scope","User",function($scope,User){$scope.User={},$scope.Services={constructor:function(){this.getUser()},getUser:function(){User.getUserData().then(function(response){$scope.User=response})}},$scope.Services.constructor()}]),angular.module("facebook").controller("AdCtrl",["$scope",function($scope){}]),angular.module("facebook").factory("User",["$q",function($q){var Users=[{id:"5904e06beb0be6209369edee",firstName:"Robles",lastName:"Leach Mccormick",age:27,gender:"male",email:"roblesmccormick@insurety.com",password:"Robles123"},{id:"5904e06b1a37e719bf09ea5e",firstName:"Hatfield",lastName:"Mcfadden Parker",age:30,gender:"male",email:"hatfieldparker@insurety.com",password:"Hatfield123"},{id:"5904e06b3058dc7c17013243",firstName:"Dona",lastName:"Dixon Howell",age:31,gender:"female",email:"donahowell@insurety.com",password:"Dona123"},{id:"5904e06bed37e96fc6ab138c",firstName:"Dejesus",lastName:"Bonner Schroeder",age:37,gender:"male",email:"dejesusschroeder@insurety.com",password:"Dejesus123"},{id:"5904e06b01a6a55717366dfe",firstName:"Moreno",lastName:"Nolan Hutchinson",age:38,gender:"male",email:"morenohutchinson@insurety.com",password:"Moreno123"},{id:"5904e06be7c48bdcadd6aa7b",firstName:"Holly",lastName:"Parsons Patrick",age:33,gender:"female",email:"hollypatrick@insurety.com",password:"Holly123"},{id:"5904e06ba7439177a15554db",firstName:"Kaitlin",lastName:"Berry Christensen",age:39,gender:"female",email:"kaitlinchristensen@insurety.com",password:"Kaitlin123"},{id:"5904e06b5f1fd131d789e1e3",firstName:"Ochoa",lastName:"Johnston Bailey",age:20,gender:"male",email:"ochoabailey@insurety.com",password:"Ochoa123"},{id:"5904e06bfd1817a8618ba150",firstName:"Kendra",lastName:"Mercado Weaver",age:30,gender:"female",email:"kendraweaver@insurety.com",password:"Kendra123"},{id:"5904e06b6dfc263628eefef4",firstName:"Melissa",lastName:"Cooke Middleton",age:20,gender:"female",email:"melissamiddleton@insurety.com",password:"Melissa123"},{id:"5904e06bebe910929c9ba90b",firstName:"Sears",lastName:"Hull Howard",age:27,gender:"male",email:"searshoward@insurety.com",password:"Sears123"},{id:"5904e06b085f2244e985a6a0",firstName:"Owen",lastName:"Sweeney Sanford",age:21,gender:"male",email:"owensanford@insurety.com",password:"Owen123"},{id:"5904e06bb2a2e096cc8b4fb2",firstName:"Sadie",lastName:"Ball Herrera",age:37,gender:"female",email:"sadieherrera@insurety.com",password:"Sadie123"},{id:"5904e06bc0615c04e04355fc",firstName:"Rita",lastName:"Mcleod Whitehead",age:36,gender:"female",email:"ritawhitehead@insurety.com",password:"Rita123"},{id:"5904e06bdebdf6fe35f69568",firstName:"Loretta",lastName:"Ray Rowland",age:21,gender:"female",email:"lorettarowland@insurety.com",password:"Loretta123"},{id:"5904e06bc6adb13098ea0445",firstName:"Mitchell",lastName:"Miranda Malone",age:35,gender:"male",email:"mitchellmalone@insurety.com",password:"Mitchell123"},{id:"5904e06bfd9187f4222494b5",firstName:"Emerson",lastName:"Daniel Mann",age:25,gender:"male",email:"emersonmann@insurety.com",password:"Emerson123"},{id:"5904e06b08a7c048b983bf03",firstName:"Crane",lastName:"Bean Hodge",age:36,gender:"male",email:"cranehodge@insurety.com",password:"Crane123"},{id:"5904e06bcdfceca3cf4d33e7",firstName:"Carson",lastName:"Andrews Benjamin",age:22,gender:"male",email:"carsonbenjamin@insurety.com",password:"Carson123"},{id:"5904e06b7c9f5b938cb175c9",firstName:"Sallie",lastName:"Bruce Marsh",age:23,gender:"female",email:"salliemarsh@insurety.com",password:"Sallie123"}];return{createUsers:function(){localStorage.setItem("Users",JSON.stringify(Users))},getUsers:function(){return JSON.parse(localStorage.getItem("Users"))},setUserId:function(id){localStorage.setItem("userId",id)},getUserId:function(){return localStorage.getItem("userId")},getUserData:function(){var deferred=$q.defer(),userId=localStorage.getItem("userId");return Users.forEach(function(user){user.id==userId&&deferred.resolve(user)}),deferred.promise},login:function(form){var deferred=$q.defer(),flag=!1,sendUser={},response={};return Users.forEach(function(user){user.email==form.email&&user.password==form.password&&(flag=!0,sendUser=user)}),flag?(response={status:200,user:sendUser},deferred.resolve(response)):(response={status:401,message:"EL usuario no se encuentra registrado."},deferred.reject(response)),deferred.promise}}}]),angular.module("facebook").factory("Post",["$q","Generator","User",function($q,Generator,User){return{updatePosts:function(posts){localStorage.setItem("Posts",JSON.stringify(posts))},list:function(){return JSON.parse(localStorage.getItem("Posts"))},create:function(post){var deferred=$q.defer(),posts=this.list()||[];return post.id=Generator.uniqueId(),posts.push(post),this.updatePosts(posts),deferred.resolve(post),deferred.promise},getPostByUser:function(userId){var deferred=$q.defer(),posts=this.list()||[],response=[],users=User.getUsers();return posts.forEach(function(post){if(post.userId==userId){var obj=post;users.forEach(function(user){user.id==userId&&(obj.user=user)}),response.push(post)}}),deferred.resolve(response),deferred.promise},remove:function(postId){var deferred=$q.defer(),posts=this.list()||[];return posts.forEach(function(post,i,a){post.id==postId&&a.splice(i,1)}),this.updatePosts(posts),deferred.resolve({status:200}),deferred.promise},save:function(postId,statement){var deferred=$q.defer(),posts=this.list()||[];return posts.forEach(function(post){post.id==postId&&(post.statement=statement)}),this.updatePosts(posts),deferred.resolve({status:200}),deferred.promise}}}]);